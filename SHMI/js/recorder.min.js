window.setInterval("update()",500);var UpdateInterval=1E3,data=[],einheit="\u00b0C"; $(function(){function a(){var h=[];p.find("input:checked").each(function(){var b=$(this).attr("name");b&&n[b]&&h.push(n[b])});0<h.length&&(plot=$.plot("#chart",h,c))}function e(){var h;moment().format("HH:mm:ss");var b=data.length,a=parseFloat($("."+$("#ID_analog_select").val()).val());200<b&&(k.series.curvedLines.curvePointFactor=5);400<b&&(k.series.curvedLines.active=!1);3600<b&&data.shift();120<l.length&&l.shift();f>a&&(f=a);a>g&&(g=a);h=(g-f)/2+f;c.grid.markings=[{yaxis:{from:g,to:g},color:"rgba(0,0,255,0.6)", lineWidth:1.5},{yaxis:{from:f,to:f},color:"rgba(0,255,0,0.7)",lineWidth:1.5},{yaxis:{from:h,to:h},color:"rgba(64,64,64,0.5)",lineWidth:2}];data.push([moment(),a]);l.push([moment(),a]);!1==m&&(plot=$.plot("#chart",[l],c),overview=$.plot("#overview",[data],k),$(".cur_value").val(Round(a,2)+" "+einheit),$(".min_value").val(Round(f,2)+" "+einheit),$(".max_value").val(Round(g,2)+" "+einheit),$(".avg_value").val(Round(h,2)+" "+einheit));$("#DataSize").val(b);setTimeout(e,UpdateInterval)}function d(){overview= $.plot("#overview",[data],k);plot=$.plot("#chart",[l],c)}function q(){$("#IDPause").hasClass("active")?m||$("#IDPauseIcon").removeClass("glyphicon-play").addClass("glyphicon-pause"):$("#IDPauseIcon").removeClass("glyphicon-pause").addClass("glyphicon-play")}var l=[],m=!1,g,f;f=1E4;g=0;var n={data:{lines:{show:!0,lineWidth:2},data:data}},r=0;$.each(n,function(a,b){b.color=r;++r});var p=$("#choices");$.each(n,function(a,b){p.append("<br/><input style='display:hidden' type='checkbox' name='"+a+"' checked='checked' id='id"+ a+"'></input><label for='id"+a+"'>"+b.label+"</label>")});p.find("input").click(a);var c={yaxis:{min:0},xaxis:{mode:"time",timeformat:"%H:%M:%S",minTickSize:[1,"second"]},series:{lines:{show:!0,lineWidth:1.5,fill:!0,fillColor:"rgba(128, 128, 128, 0.3)"},curvedLines:{active:!1,apply:!0,fit:!0,curvePointFactor:15,fitPointDist:10},points:{show:!0,radius:2,symbol:"circle"},shadowSize:5},colors:["rgba(255,0,0,0.8)"],selection:{mode:"x"},grid:{backgroundColor:"#ccc",markings:[]}};a();var k={series:{lines:{show:!0, lineWidth:1,fill:!0,fillColor:"rgba(64, 64, 64, 0.8)"},curvedLines:{active:!1,fit:!0,apply:!0,curvePointFactor:10},shadowSize:0},xaxis:{timeformat:"%H:%M:%S",mode:"time",minTickSize:[1,"minute"]},yaxis:{ticks:[],min:0,autoscaleMargin:0.1},selection:{mode:"x"},colors:["#bbb"]};overview=$.plot("#overview",[],k);$("#chart").bind("plotselected",function(a,b){plot=$.plot("#chart",[data],$.extend(!0,{},c,{xaxis:{min:b.xaxis.from,max:b.xaxis.to}}));m=!0;$("#IDPause").addClass("active");q();overview.setSelection(b, !0)});$("#overview").bind("plotselected",function(a,b){plot.setSelection(b)});setTimeout(e,UpdateInterval);$("#IDsmooth").click(function(){c.series.curvedLines.active=c.series.curvedLines.active?!1:!0;k.series.curvedLines.active=k.series.curvedLines.active?!1:!0;c.series.points.show=c.series.points.show?!1:!0;d()});$("#IDfill").click(function(){c.series.lines.fill=c.series.lines.fill?!1:!0;d()});$("#IDlight").click(function(){$("#IDlight").hasClass("active")?(c.grid.backgroundColor="#ccc",c.xaxis.font= {size:12,color:"#ccc",weight:"normal"},c.yaxis.font={size:12,color:"#ccc",weight:"normal"}):(c.grid.backgroundColor="#fff",c.xaxis.font={size:12,color:"#fff",weight:"bold"},c.yaxis.font={size:12,color:"#fff",weight:"bold"});d()});$("#IDmaxReset").click(function(){g=0});$("#IDminReset").click(function(){f=g});$("#IDPause").click(function(){m=m?!1:!0;q()});$("#IDDataReset").click(function(){BootstrapDialog.confirm('<div class="alert alert-warning">Really Reset Data?</div>',function(a){a&&(l=[],data= [],d())})});$(window).resize(function(){plot.resize();plot.setupGrid();plot.draw();overview.resize();overview.setupGrid();overview.draw()})});jQuery.browser={};(function(){jQuery.browser.msie=!1;jQuery.browser.version=0;navigator.userAgent.match(/MSIE ([0-9]+)\./)&&(jQuery.browser.msie=!0,jQuery.browser.version=RegExp.$1)})(); var UpdateIntervalOptions=function(){for(var a=1;121>a;a++)oOption=document.createElement("option"),oOption.text=a,oOption.value=1E3*a,document.getElementById("updateInterval").add(oOption)},update=function(){$.getJSON("./data/data.json",function(a){$.each(a,function(a,d){$("."+a).each(function(){$(this).text(d);$(this).val(d)})})})},Download=function(){for(var a=[],e=0,d=data.length;e<d;++e)a.push(data[e].join(";"));e=a.join("%0A");a=moment().format()+"_Data.csv";$.browser.msie?(e=new Blob([e],{type:"text/csv;charset=utf-8;"}), navigator.msSaveBlob(e,a)):(d=document.createElement("a"),d.href="data:text/csv;charset=utf-8,"+e,d.target="_blank",d.download=a,document.body.appendChild(d),d.click())};
