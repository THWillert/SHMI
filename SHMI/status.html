<!DOCTYPE html>
<html>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<script type="text/javascript" src="./js/main.js"></script>
<script type="text/javascript" src="./js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="./js/jquery.peity.min.js"></script>
<script src="./js/bootstrap.min.js"></script>

<script src="./js/jquery.peity.js"></script>

<link rel="stylesheet" href="./css/bootstrap.min.css">

<link href="./css/default.css" rel="stylesheet" type="text/css">
<script type='text/javascript'>

$(function() {
//==============================================================================
	var digital_in_container = $("#ID_digital_in");
	var digital_out_container = $("#ID_digital_out");
	var analog_in_container = $("#ID_analog_in");
	var analog_out_container = $("#ID_analog_out");
//==============================================================================
	function init()
	{
		// Anzeigen einfügen
		$.getJSON( "./data/data.json", function( data ) {
			$.each( data, function( id, val) {

			if ( id.indexOf("SP") == -1){
				if ( id.indexOf("DI") != -1) {
					digital_in_container.append('<tr><td width="300px" id="TXT_' + id + '"></td>' +
							'<td><div class="digi_back"><span id="ID_' + id + '_D" class="digi input">&nbsp;</span></div></td></tr>');
				} else if ( id.indexOf("DO") != -1) {
					digital_out_container.append('<tr><td width="300px" id="TXT_' + id + '"></td>' +
							'<td><div class="digi_back"><span id="ID_' + id + '_D" class="digi output">&nbsp;</span></div></td></tr>');
				} else if ( id.indexOf("AI") != -1 && id.indexOf("SP") == -1) {
					analog_in_container.append('<tr><td width="300px" id="TXT_' + id + '"></td>' +
							'<td width="6em"><input class="analog ' + id + '" disabled></td>' +
							'<td width="60%">' +
							'<div class="meter_back">' +
							'<span id="ID_' + id + '_M" class="meter input">&nbsp;</span>' +
							'<span id="ID_' + id + '_SP_SP" class="setpoint_bar">&nbsp;</span>' +
							'</div></td>' +
							'<td><input class="analog ' + id + '_SP" disabled></td>' +
							'</tr>');

				}  else if ( id.indexOf("AO") != -1) {
					analog_out_container.append('<tr><td width="300px" id="TXT_' + id + '"></td>' +
							'<td width="6em"><input class="analog ' + id + '" disabled></td>' +
							'<td width="60%">' +
							'<div class="meter_back">' +
							'<span id="ID_' + id + '_M" class="meter output">&nbsp;</span>' +
							'<span id="ID_' + id + '_SP_SP" class="setpoint_bar">&nbsp;</span>' +
							'</div></td>' +
							'<td><input class="analog ' + id + '_SP" disabled></td>' +
							'</tr>');
				};
			};
			});
		});

		// Beschriftung einfügen
		$.getJSON( "./lng/de.jsn", function( data ) {
			$.each( data, function( id, val) {
				$("#TXT_" + id).each( function() {
					$(this).text(val);
				});
			});
		});


	}
	init();

//==============================================================================
	function updateValues()
	{
	var id;
	var val;
		parent.top.$("#IDdata").find("input").each( function() {
			id = this.id;
			val = Round( this.value,2);

			$("#IDAnalogIO").find( "." + id).each( function() {
				//$(this).text( val);
				this.value = val;
			});
			$("#ID_" + id + "_M").css("width", val + "%" ); // meter
			$("#ID_" + id + "_SP").css("width", val  + "%" ) ; // sollwert
			$("#ID_" + id + "_D").css("opacity",  val ); // digital
		});
		setTimeout(updateValues, 1000);
	};
	$(function(){updateValues();});

//==============================================================================
});

</script>
</head>
<body>
<div class="main w100">
	<div class="col-md-6">
	<div class="panel panel-default shadow">
		<div class="panel-heading">
			<h3 class="panel-title" id="TXT_DI">DI</h3>
		</div>
		<div class="panel-body">
			<table id="ID_digital_in"></table>
		</div>
	</div>
	</div>

	<div class="col-md-6">
	<div class="panel panel-default shadow">
		<div class="panel-heading">
			<h3 class="panel-title" id="TXT_DO">DO</h3>
		</div>
		<div class="panel-body">
			<table id="ID_digital_out"></table>
		</div>
	</div>
	</div>

	<div id="IDAnalogIO">
		<div class="col-md-12">
		<div class="panel panel-default shadow">
			<div class="panel-heading">
				<h3 class="panel-title" id="TXT_AI">AI</h3>
			</div>
			<div class="panel-body table-responsive">
				<table id="ID_analog_in">
				<tr><th></th><th></th><th></th><th id="TXT_Setpoint_AI">SP</th></tr>
				</table>
			</div>
		</div>
		</div>

		<div class="col-md-12">
		<div class="panel panel-default shadow">
			<div class="panel-heading">
				<h3 class="panel-title" id="TXT_AO">AO</h3>
			</div>
			<div class="panel-body table-responsive">
				<table id="ID_analog_out">
					<tr><th></th><th></th><th></th><th id="TXT_Setpoint_AO">SP</th></tr>
				</table>
			</div>
		</div>
		</div>
	</div>

</div>
</body>
</html>
